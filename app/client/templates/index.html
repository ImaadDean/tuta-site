{% extends "base.html" %}
{% block title %}E-Commerce Store{% endblock %}
{% block content %}
  <div class="w-full max-w-7xl mx-auto">
  <!-- Toast notification for cart add - DISABLED 
  <div 
    x-data="{ show: false, message: '' }"
    x-on:cart-added.window="show = true; message = $event.detail.name; setTimeout(() => show = false, 2000)"
    x-show="show"
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="opacity-0 transform translate-y-2"
    x-transition:enter-end="opacity-100 transform translate-y-0"
    x-transition:leave="transition ease-in duration-100"
    x-transition:leave-start="opacity-100 transform translate-y-0"
    x-transition:leave-end="opacity-0 transform translate-y-2"
    class="fixed bottom-4 right-4 bg-green-500 text-white py-2 px-4 rounded-md shadow-lg z-50 flex items-center"
    style="display: none;"
  >
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
    </svg>
    <span x-text="message + ' added to cart'"></span>
  </div>
  -->
  
  <!-- Toast notification for favorites - DISABLED 
  <div 
    x-data="{ 
      show: false, 
      productId: null,
      action: null,
      getProductName(id) {
        // Find the product in all available products
        const products = [...Array.from(document.querySelectorAll('[data-product-id]')).map(el => ({
          id: el.dataset.productId,
          name: el.dataset.productName
        }))];
        const product = products.find(p => p.id === id);
        return product ? product.name : 'Product';
      }
    }"
    x-on:favorite-changed.window="
      show = true; 
      productId = $event.detail.id;
      action = $event.detail.action;
      setTimeout(() => show = false, 2000)
    "
    x-show="show"
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="opacity-0 transform translate-y-2"
    x-transition:enter-end="opacity-100 transform translate-y-0"
    x-transition:leave="transition ease-in duration-100"
    x-transition:leave-start="opacity-100 transform translate-y-0"
    x-transition:leave-end="opacity-0 transform translate-y-2"
    class="fixed bottom-20 right-4 py-2 px-4 rounded-md shadow-lg z-50 flex items-center"
    :class="action === 'added' ? 'bg-red-500 text-white' : 'bg-gray-700 text-white'"
    style="display: none;"
  >
    <template x-if="action === 'added'">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd" />
      </svg>
    </template>
    <template x-if="action === 'removed'">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
      </svg>
    </template>
    <span x-text="getProductName(productId) + (action === 'added' ? ' added to favorites' : ' removed from favorites')"></span>
  </div>
  -->
  
  <!-- Toast Notification Component - KEEP THIS ONE -->
  <div
    x-data="{
      notifications: [],
      add(message, type = 'info') {
        const id = Date.now();
        this.notifications.push({
          id,
          message,
          type
        });
        setTimeout(() => {
          this.remove(id);
        }, 2000);
      },
      remove(id) {
        this.notifications = this.notifications.filter(notification => notification.id !== id);
      }
    }"
    @show-notification.window="add($event.detail.message, $event.detail.type)"
    class="fixed top-4 inset-x-0 z-50 flex flex-col items-center justify-start space-y-2 px-4 py-2 pointer-events-none sm:items-end sm:right-4 sm:left-auto"
  >
    <template x-for="notification in notifications" :key="notification.id">
      <div
        x-show="true"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0 transform -translate-y-2"
        x-transition:enter-end="opacity-100 transform translate-y-0"
        x-transition:leave="transition ease-in duration-150"
        x-transition:leave-start="opacity-100 transform translate-y-0"
        x-transition:leave-end="opacity-0 transform -translate-y-2"
        class="flex items-center justify-between w-full max-w-sm rounded-lg shadow-lg border p-2 pointer-events-auto"
        :class="{
          'bg-green-50 border-green-200': notification.type === 'success',
          'bg-blue-50 border-blue-200': notification.type === 'info',
          'bg-yellow-50 border-yellow-200': notification.type === 'warning',
          'bg-red-50 border-red-200': notification.type === 'error'
        }"
      >
        <div class="flex items-center">
          <!-- Success Icon -->
          <div 
            x-show="notification.type === 'success'"
            class="flex-shrink-0 w-5 h-5 bg-green-100 rounded-full flex items-center justify-center mr-2"
          >
            <svg class="w-3 h-3 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
          </div>
          
          <!-- Info Icon -->
          <div 
            x-show="notification.type === 'info'"
            class="flex-shrink-0 w-5 h-5 bg-blue-100 rounded-full flex items-center justify-center mr-2"
          >
            <svg class="w-3 h-3 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          
          <!-- Warning Icon -->
          <div 
            x-show="notification.type === 'warning'"
            class="flex-shrink-0 w-5 h-5 bg-yellow-100 rounded-full flex items-center justify-center mr-2"
          >
            <svg class="w-3 h-3 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
            </svg>
          </div>
          
          <!-- Error Icon -->
          <div 
            x-show="notification.type === 'error'"
            class="flex-shrink-0 w-5 h-5 bg-red-100 rounded-full flex items-center justify-center mr-2"
          >
            <svg class="w-3 h-3 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </div>
          
          <span 
            class="text-sm font-medium"
            :class="{
              'text-green-800': notification.type === 'success',
              'text-blue-800': notification.type === 'info',
              'text-yellow-800': notification.type === 'warning',
              'text-red-800': notification.type === 'error'
            }"
            x-text="notification.message"
          ></span>
        </div>
        
        <button 
          @click="remove(notification.id)" 
          class="ml-2 flex-shrink-0 text-gray-400 hover:text-gray-500 focus:outline-none"
        >
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
    </template>
  </div>
  
    {% include "components/banner.html" %}
    <!-- Add this after the banner section and before the products section -->
    <div class="mb-8">
      <div class="container mx-auto px-4">
        <div class="flex items-center gap-2.5 overflow-auto has-scrollbar">
          {% for category in categories %}
          <div
            class="min-w-full md:min-w-[calc(50%-15px)] lg:min-w-[calc(33.33%-20px)] xl:min-w-[calc(25%-22.5px)] flex rounded-md snap-start border border-cultured overflow-hidden"
          >
            <!-- Image section that spans full height -->
            <div
              class="w-1/3 bg-cover bg-center"
              style="background-image: url('{{ category.icon_url }}');"
            ></div>
  
            <!-- Content section -->
            <div class="w-3/4 p-4">
              <div class="flex justify-between items-center mb-2.5">
                <h3 class="text-eerie-black text-xs font-semibold uppercase">
                  {{ category.name }}
                </h3>
                <p class="text-sonic-silver text-[11px]">
                  ({{ category.product_count }})
                </p>
              </div>
  
              <a
                href="/category/{{ category.id }}"
                class="text-salmon-pink text-xs font-medium capitalize"
                >Show all</a
              >
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  
    {% include "components/main.html" %}
  
    <style>
      /* Add this to your existing styles */
      .has-scrollbar {
        scrollbar-width: none;
        -ms-overflow-style: none;
        scroll-snap-type: x mandatory;
        scroll-behavior: smooth;
        -webkit-overflow-scrolling: touch;
      }
  
      .has-scrollbar::-webkit-scrollbar {
        display: none;
      }
  
      .snap-start {
        scroll-snap-align: start;
      }
    </style>
  

  </div>
  
  <style>
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
  </style>
  {% endblock %}